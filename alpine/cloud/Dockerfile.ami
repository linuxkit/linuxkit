FROM alpine

RUN apk add --update \
    python \
    py-pip \
    curl \
    e2fsprogs \
    jq \
    syslinux
RUN pip install -U awscli
RUN mkdir /build
RUN mkdir /scripts
WORKDIR /scripts
COPY ./kernel/x86_64/vmlinuz64 /build
COPY ./initrd.img /build
COPY ./cloud/aws/syslinux.cfg /build/syslinux.cfg
COPY ./cloud/build-common.sh .
COPY ./cloud/aws/common.sh .
COPY ./cloud/aws/aws.sh .
COPY ./cloud/aws/bake-ami.sh .

ENTRYPOINT ["./aws.sh"]

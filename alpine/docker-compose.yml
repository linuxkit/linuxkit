version: '2'
services:
  moby:
    build:
      context: .
    network_mode: bridge
    volumes:
      - .:/mnt
  efi:
    cap_add:
      - sys_admin
    build:
      context: .
      dockerfile: Dockerfile.efi
    network_mode: bridge
    volumes:
      - .:/mnt
  bios:
    build:
      context: .
      dockerfile: Dockerfile.bios
    network_mode: bridge
    volumes:
      - .:/mnt
  arm:
    build:
      context: .
      dockerfile: Dockerfile.armhf
    network_mode: bridge
  ami:
    privileged: true
    build:
      context: .
      dockerfile: Dockerfile.ami
    network_mode: bridge
    volumes:
      - .:/mnt
      - $HOME/.aws:/root/.aws:ro
      - /dev:/dev

version: '2'
services:
  moby:
    build:
      context: .
    network_mode: bridge
    volumes:
      - .:/mnt
  efi:
    cap_add:
      - sys_admin
    build:
      context: .
      dockerfile: Dockerfile.efi
    network_mode: bridge
    volumes:
      - .:/mnt
  bios:
    build:
      context: .
      dockerfile: Dockerfile.bios
    network_mode: bridge
    volumes:
      - .:/mnt
  arm:
    build:
      context: .
      dockerfile: Dockerfile.armhf
    network_mode: bridge
  azure:
    privileged: true
    build:
      context: cloud
      dockerfile: Dockerfile.azure
    network_mode: bridge
    environment:
      AZURE_STG_ACCOUNT_KEY: 
    volumes:
      - .:/mnt
      - /dev:/dev
  ami:
    privileged: true
    build:
      context: cloud
      dockerfile: Dockerfile.ami
    network_mode: bridge
    volumes:
      - .:/mnt
      - $HOME/.aws:/root/.aws:ro
      - /dev:/dev
